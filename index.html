<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Management Dashboard â€” GeorgiosGkaripis</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&family=DM+Mono:wght@400;500&display=swap');

        :root {
            --blue: #1a56db;
            --blue-light: #3b82f6;
            --blue-pale: #eff6ff;
            --orange: #f97316;
            --orange-pale: #fff7ed;
            --green: #16a34a;
            --green-pale: #f0fdf4;
            --red: #dc2626;
            --red-pale: #fef2f2;
            --yellow: #d97706;
            --yellow-pale: #fffbeb;
            --bg: #f1f5f9;
            --surface: #ffffff;
            --border: #e2e8f0;
            --text: #0f172a;
            --text-muted: #64748b;
            --text-light: #94a3b8;
            --radius: 12px;
            --shadow: 0 1px 3px rgba(0,0,0,0.06), 0 4px 16px rgba(0,0,0,0.04);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1), 0 1px 4px rgba(0,0,0,0.06);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        /* â”€â”€ SIDEBAR â”€â”€ */
        .app-shell { display: flex; min-height: 100vh; }

        .sidebar {
            width: 260px;
            min-height: 100vh;
            background: var(--text);
            color: #fff;
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0; left: 0;
            z-index: 100;
        }

        .sidebar-logo {
            padding: 28px 24px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }

        .sidebar-logo h2 {
            font-size: 15px;
            font-weight: 700;
            letter-spacing: 0.02em;
            color: #fff;
        }

        .sidebar-logo span {
            font-size: 12px;
            color: rgba(255,255,255,0.45);
            font-weight: 400;
        }

        .sidebar-nav {
            padding: 16px 12px;
            flex: 1;
        }

        .nav-label {
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.1em;
            color: rgba(255,255,255,0.3);
            text-transform: uppercase;
            padding: 8px 12px 6px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            color: rgba(255,255,255,0.65);
            transition: all 0.15s;
            margin-bottom: 2px;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
        }

        .nav-item:hover { background: rgba(255,255,255,0.08); color: #fff; }
        .nav-item.active { background: var(--blue); color: #fff; }

        .nav-item .icon { font-size: 16px; width: 20px; text-align: center; }
        .nav-badge {
            margin-left: auto;
            background: var(--orange);
            color: #fff;
            font-size: 10px;
            font-weight: 700;
            padding: 1px 6px;
            border-radius: 10px;
        }

        .sidebar-footer {
            padding: 16px 24px;
            border-top: 1px solid rgba(255,255,255,0.08);
            font-size: 12px;
            color: rgba(255,255,255,0.3);
        }

        /* â”€â”€ MAIN â”€â”€ */
        .main {
            margin-left: 260px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }


        .btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.15s;
            font-family: inherit;
        }

        .btn-primary { background: var(--blue); color: #fff; }
        .btn-primary:hover { background: #1640b0; }
        .btn-ghost { background: transparent; color: var(--text-muted); border: 1px solid var(--border); }
        .btn-ghost:hover { background: var(--bg); }
        .btn-danger { background: var(--red); color: #fff; }
        .btn-danger:hover { background: #b91c1c; }
        .btn-sm { padding: 5px 10px; font-size: 12px; }

        .content { padding: 28px 32px; }

        /* â”€â”€ VIEWS â”€â”€ */
        .view { display: none; }
        .view.active { display: block; }

        /* â”€â”€ STATS â”€â”€ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 28px;
        }

        .stat-card {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 14px 16px;
            box-shadow: var(--shadow);
            border-left: 4px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .stat-card::after {
            content: '';
            position: absolute;
            right: -10px;
            top: -10px;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            opacity: 0.06;
        }

        .stat-card.blue { border-left-color: var(--blue); }
        .stat-card.blue::after { background: var(--blue); }
        .stat-card.orange { border-left-color: var(--orange); }
        .stat-card.orange::after { background: var(--orange); }
        .stat-card.green { border-left-color: var(--green); }
        .stat-card.green::after { background: var(--green); }
        .stat-card.red { border-left-color: var(--red); }
        .stat-card.red::after { background: var(--red); }
        .stat-card.purple { border-left-color: #7c3aed; }
        .stat-card.purple::after { background: #7c3aed; }

        .stat-label { font-size: 10px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 6px; }
        .stat-value { font-size: 28px; font-weight: 700; line-height: 1; margin-bottom: 4px; }
        .stat-sub { font-size: 11px; color: var(--text-light); }

        /* â”€â”€ SECTION HEADER â”€â”€ */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .section-title { font-size: 16px; font-weight: 700; }

        /* â”€â”€ PROJECT TABLE â”€â”€ */
        .table-wrap {
            background: var(--surface);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 28px;
        }

        table { width: 100%; border-collapse: collapse; }
        thead { background: var(--bg); }

        th {
            text-align: left;
            padding: 11px 16px;
            font-size: 11px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.07em;
            border-bottom: 1px solid var(--border);
        }

        td {
            padding: 13px 16px;
            font-size: 14px;
            border-bottom: 1px solid var(--border);
            vertical-align: middle;
        }

        tr:last-child td { border-bottom: none; }
        tr:hover td { background: #fafbfc; }

        .project-name { font-weight: 600; }
        .project-client { font-size: 12px; color: var(--text-muted); }

        /* â”€â”€ PROGRESS BAR â”€â”€ */
        .progress-wrap { min-width: 120px; }
        .progress-bar {
            height: 6px;
            background: var(--border);
            border-radius: 99px;
            overflow: hidden;
            margin-top: 4px;
        }
        .progress-fill { height: 100%; border-radius: 99px; transition: width 0.4s; }

        /* â”€â”€ BADGES â”€â”€ */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 3px 9px;
            border-radius: 99px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
        }

        .badge-blue { background: var(--blue-pale); color: var(--blue); }
        .badge-orange { background: var(--orange-pale); color: var(--orange); }
        .badge-green { background: var(--green-pale); color: var(--green); }
        .badge-red { background: var(--red-pale); color: var(--red); }
        .badge-yellow { background: var(--yellow-pale); color: var(--yellow); }

        /* â”€â”€ MODAL â”€â”€ */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 200;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.open { display: flex; }

        .modal {
            background: var(--surface);
            border-radius: 16px;
            width: 560px;
            max-width: 95vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-md);
            animation: modalIn 0.2s ease;
        }

        @keyframes modalIn {
            from { transform: translateY(12px) scale(0.98); opacity: 0; }
            to { transform: translateY(0) scale(1); opacity: 1; }
        }

        .modal-header {
            padding: 24px 24px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border);
        }

        .modal-title { font-size: 17px; font-weight: 700; }
        .modal-close { background: none; border: none; font-size: 20px; cursor: pointer; color: var(--text-muted); padding: 4px; }
        .modal-body { padding: 20px 24px; }
        .modal-footer { padding: 16px 24px; border-top: 1px solid var(--border); display: flex; gap: 10px; justify-content: flex-end; }

        /* â”€â”€ FORM â”€â”€ */
        .form-row { margin-bottom: 16px; }
        .form-row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 16px; }

        label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 5px; color: var(--text); }

        input[type="text"], input[type="date"], input[type="number"], textarea, select {
            width: 100%;
            padding: 9px 12px;
            border: 1.5px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            color: var(--text);
            background: var(--surface);
            transition: border-color 0.15s;
            outline: none;
        }

        input:focus, textarea:focus, select:focus { border-color: var(--blue); }
        textarea { resize: vertical; min-height: 80px; }

        /* â”€â”€ TASKS â”€â”€ */
        .task-list { list-style: none; }

        .task-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            border: 1px solid var(--border);
            margin-bottom: 8px;
            background: var(--surface);
            transition: box-shadow 0.15s;
        }

        .task-item:hover { box-shadow: var(--shadow); }

        .task-check {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 2px solid var(--border);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.15s;
        }

        .task-check.done { background: var(--green); border-color: var(--green); color: #fff; font-size: 10px; }

        .task-text { flex: 1; font-size: 14px; }
        .task-text.done { text-decoration: line-through; color: var(--text-muted); }
        .task-meta { font-size: 12px; color: var(--text-light); }

        /* â”€â”€ EMPTY STATE â”€â”€ */
        .empty {
            text-align: center;
            padding: 48px 24px;
            color: var(--text-muted);
        }
        .empty-icon { font-size: 48px; margin-bottom: 12px; }
        .empty h3 { font-size: 16px; font-weight: 600; margin-bottom: 6px; }
        .empty p { font-size: 14px; }

        /* â”€â”€ TIMELINE â”€â”€ */
        .timeline-list { list-style: none; }

        .timeline-item {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
        }

        .timeline-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-top: 4px;
            flex-shrink: 0;
        }

        .timeline-line-wrap {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .timeline-line {
            width: 2px;
            flex: 1;
            background: var(--border);
            margin-top: 4px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* â”€â”€ PRINT â”€â”€ */
        @media print {
            .sidebar, .topbar, .btn, .modal-overlay { display: none !important; }
            .main { margin-left: 0; }
            body { background: white; }
            .stat-card, .table-wrap { box-shadow: none; }
        }

        /* â”€â”€ SEARCH â”€â”€ */
        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg);
            border: 1.5px solid var(--border);
            border-radius: 8px;
            padding: 7px 12px;
            font-size: 14px;
            color: var(--text-muted);
            cursor: text;
        }

        .search-box input {
            border: none;
            background: none;
            outline: none;
            font-size: 14px;
            width: 180px;
            font-family: inherit;
        }

        /* Action icons */
        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px 6px;
            border-radius: 6px;
            color: var(--text-muted);
            font-size: 14px;
            transition: all 0.15s;
        }

        .action-btn:hover { background: var(--bg); color: var(--text); }
        .action-btn.del:hover { background: var(--red-pale); color: var(--red); }

        /* â”€â”€ GANTT â”€â”€ */
        .gantt-wrap {
            background: var(--surface);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 28px;
        }

        .gantt-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
            font-weight: 700;
            font-size: 15px;
        }

        .gantt-row {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            border-bottom: 1px solid var(--border);
            gap: 16px;
        }

        .gantt-row:last-child { border-bottom: none; }

        .gantt-label { width: 200px; font-size: 13px; font-weight: 500; flex-shrink: 0; }
        .gantt-track { flex: 1; background: var(--bg); border-radius: 4px; height: 18px; position: relative; overflow: hidden; }
        .gantt-fill {
            height: 100%;
            border-radius: 4px;
            display: flex;
            align-items: center;
            padding: 0 6px;
            font-size: 10px;
            font-weight: 700;
            color: #fff;
            white-space: nowrap;
            overflow: hidden;
        }

        .gantt-pct { width: 40px; font-size: 12px; color: var(--text-muted); text-align: right; font-family: 'DM Mono', monospace; }

        /* â”€â”€ NOTES â”€â”€ */
        .notes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 16px;
        }

        .note-card {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 18px;
            box-shadow: var(--shadow);
            border-top: 4px solid var(--blue);
            position: relative;
        }

        .note-card .note-date { font-size: 11px; color: var(--text-light); margin-bottom: 8px; }
        .note-card .note-text { font-size: 13px; line-height: 1.6; }
        .note-card .note-actions { margin-top: 12px; display: flex; gap: 6px; }
    </style>
</head>
<body>

<div class="app-shell">

    <!-- â•â•â• SIDEBAR â•â•â• -->
    <nav class="sidebar">
        <div class="sidebar-logo">
            <h2>Î Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï… Î­ÏÎ³Î¿Ï…</h2>
            <span>Î“ÎºÎ±ÏÎ¯Ï€Î·Ï‚ Î“Î¹ÏÏÎ³Î¿Ï‚</span>
        </div>
        <div class="sidebar-nav">
            <div class="nav-label">ÎšÏÏÎ¹Î± ÎœÎµÎ½Î¿Ï</div>
            <button class="nav-item active" onclick="navigate('dashboard', this)">
                <span class="icon">ğŸ“Š</span> Î•Ï€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ·
            </button>
            <button class="nav-item" onclick="navigate('projects', this)">
                <span class="icon">ğŸ—ï¸</span> ÎˆÏÎ³Î±
                <span class="nav-badge" id="nav-badge-projects">0</span>
            </button>
            <button class="nav-item" onclick="navigate('tasks', this)">
                <span class="icon">âœ…</span> Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚
                <span class="nav-badge" id="nav-badge-tasks">0</span>
            </button>
            <button class="nav-item" onclick="navigate('timeline', this)">
                <span class="icon">ğŸ“…</span> Î§ÏÎ¿Î½Î¿Î´Î¹Î¬Î³ÏÎ±Î¼Î¼Î±
            </button>
            <div class="nav-label" style="margin-top:16px;">Î’Î¿Î·Î¸Î·Ï„Î¹ÎºÎ¬</div>
            <button class="nav-item" onclick="navigate('notes', this)">
                <span class="icon">ğŸ“</span> Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚
            </button>
            <button class="nav-item" onclick="window.print()">
                <span class="icon">ğŸ–¨ï¸</span> Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ· / PDF
            </button>
            <button class="nav-item" onclick="saveAsFile()">
                <span class="icon">ğŸ’¾</span> Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î‘ÏÏ‡ÎµÎ¯Î¿Ï…
            </button>
        </div>
        <div class="sidebar-footer" style="line-height:1.7;">
            <span style="display:inline-flex;align-items:center;gap:0px;vertical-align:baseline;font-size:11px;">&copy;&reg;</span>&thinsp;GeorgiosGkaripis<br>
            ÎœÎµ ÎµÏ€Î¹Ï†ÏÎ»Î±Î¾Î· Ï€Î±Î½Ï„ÏŒÏ‚ Î´Î¹ÎºÎ±Î¹ÏÎ¼Î±Ï„Î¿Ï‚.
        </div>
    </nav>

    <!-- â•â•â• MAIN â•â•â• -->
    <div class="main">
        <!-- CONTENT -->
        <div class="content">

            <!-- â”€â”€â”€ DASHBOARD VIEW â”€â”€â”€ -->
            <div class="view active" id="view-dashboard">
                <div class="stats-grid" id="stats-grid"></div>

                <div class="section-header">
                    <div class="section-title">Î ÏÏŒÏƒÏ†Î±Ï„Î± ÎˆÏÎ³Î±</div>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr>
                                <th>ÎˆÏÎ³Î¿</th>
                                <th>ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</th>
                                <th>Î ÏÏŒÎ¿Î´Î¿Ï‚</th>
                                <th>Î—Î¼/Î½Î¯Î± Î›Î®Î¾Î·Ï‚</th>
                            </tr>
                        </thead>
                        <tbody id="dashboard-projects-tbody"></tbody>
                    </table>
                </div>

                <div class="gantt-wrap">
                    <div class="gantt-header">ğŸ“Š Î ÏÏŒÎ¿Î´Î¿Ï‚ ÎˆÏÎ³Ï‰Î½</div>
                    <div id="gantt-body"></div>
                </div>
            </div>

            <!-- â”€â”€â”€ PROJECTS VIEW â”€â”€â”€ -->
            <div class="view" id="view-projects">
                <div class="section-header" style="margin-bottom:16px;">
                    <div class="section-title">ÎˆÏÎ³Î±</div>
                    <button class="btn btn-primary" onclick="openProjectModal()">+ ÎÎ­Î¿ ÎˆÏÎ³Î¿</button>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr>
                                <th>ÎˆÏÎ³Î¿ / Î ÎµÎ»Î¬Ï„Î·Ï‚</th>
                                <th>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</th>
                                <th>ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</th>
                                <th>Î ÏÏŒÎ¿Î´Î¿Ï‚</th>
                                <th>Î—Î¼/Î½Î¯Î± Î›Î®Î¾Î·Ï‚</th>
                                <th>Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚</th>
                                <th>Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚</th>
                            </tr>
                        </thead>
                        <tbody id="projects-tbody"></tbody>
                    </table>
                </div>
            </div>

            <!-- â”€â”€â”€ TASKS VIEW â”€â”€â”€ -->
            <div class="view" id="view-tasks">
                <div class="section-header" style="margin-bottom:16px;">
                    <div class="section-title">Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚</div>
                    <button class="btn btn-primary" onclick="openTaskModal()">+ ÎÎ­Î± Î•ÏÎ³Î±ÏƒÎ¯Î±</button>
                </div>
                <ul class="task-list" id="tasks-list"></ul>
            </div>

            <!-- â”€â”€â”€ TIMELINE VIEW â”€â”€â”€ -->
            <div class="view" id="view-timeline">
                <div class="gantt-wrap">
                    <div class="gantt-header">ğŸ“… Î§ÏÎ¿Î½Î¿Î´Î¹Î¬Î³ÏÎ±Î¼Î¼Î± ÎˆÏÎ³Ï‰Î½</div>
                    <div id="timeline-body"></div>
                </div>
            </div>

            <!-- â”€â”€â”€ NOTES VIEW â”€â”€â”€ -->
            <div class="view" id="view-notes">
                <div class="section-header" style="margin-bottom:16px;">
                    <div class="section-title">Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚</div>
                    <button class="btn btn-primary" onclick="openNoteModal()">+ ÎÎ­Î± Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·</button>
                </div>
                <div class="notes-grid" id="notes-grid"></div>
            </div>

        </div><!-- /content -->
    </div><!-- /main -->
</div><!-- /app-shell -->

<!-- â•â•â• MODALS â•â•â• -->

<!-- PROJECT MODAL -->
<div class="modal-overlay" id="project-modal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title" id="project-modal-title">ÎÎ­Î¿ ÎˆÏÎ³Î¿</div>
            <button class="modal-close" onclick="closeModal('project-modal')">âœ•</button>
        </div>
        <div class="modal-body">
            <div class="form-row">
                <label>Î¤Î¯Ï„Î»Î¿Ï‚ ÎˆÏÎ³Î¿Ï… *</label>
                <input type="text" id="p-title" placeholder="Ï€.Ï‡. ÎšÎ±Ï„Î¿Î¹ÎºÎ¯Î± ÎšÎ¿Î»Ï‰Î½Î±ÎºÎ¯Î¿Ï…">
            </div>
            <div class="form-row-2">
                <div>
                    <label>Î ÎµÎ»Î¬Ï„Î·Ï‚</label>
                    <input type="text" id="p-client" placeholder="ÎŸÎ½Î¿Î¼Î±Ï„ÎµÏ€ÏÎ½Ï…Î¼Î¿ / Î•Ï„Î±Î¹ÏÎµÎ¯Î±">
                </div>
                <div>
                    <label>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</label>
                    <select id="p-category">
                        <option>ÎšÎ±Ï„Î¿Î¹ÎºÎ¯Î±</option>
                        <option>Î•Î¼Ï€Î¿ÏÎ¹ÎºÏŒ</option>
                        <option>Î’Î¹Î¿Î¼Î·Ï‡Î±Î½Î¹ÎºÏŒ</option>
                        <option>Î”Î·Î¼ÏŒÏƒÎ¹Î¿</option>
                        <option>Î‘Î½Î±ÎºÎ±Î¯Î½Î¹ÏƒÎ·</option>
                        <option>ÎœÎµÎ»Î­Ï„Î·</option>
                        <option>Î†Î»Î»Î¿</option>
                    </select>
                </div>
            </div>
            <div class="form-row-2">
                <div>
                    <label>Î—Î¼. ÎˆÎ½Î±ÏÎ¾Î·Ï‚</label>
                    <input type="date" id="p-start">
                </div>
                <div>
                    <label>Î—Î¼. Î›Î®Î¾Î·Ï‚</label>
                    <input type="date" id="p-end">
                </div>
            </div>
            <div class="form-row-2">
                <div>
                    <label>ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</label>
                    <select id="p-status">
                        <option value="Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚">ğŸ”µ Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚</option>
                        <option value="Î£Îµ ÎµÎ¾Î­Î»Î¹Î¾Î·">ğŸŸ  Î£Îµ ÎµÎ¾Î­Î»Î¹Î¾Î·</option>
                        <option value="Î£Îµ Ï€Î±ÏÏƒÎ·">ğŸŸ¡ Î£Îµ Ï€Î±ÏÏƒÎ·</option>
                        <option value="ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿">ğŸŸ¢ ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿</option>
                        <option value="Î‘ÎºÏ…ÏÏ‰Î¼Î­Î½Î¿">ğŸ”´ Î‘ÎºÏ…ÏÏ‰Î¼Î­Î½Î¿</option>
                    </select>
                </div>
                <div>
                    <label>Î ÏÏŒÎ¿Î´Î¿Ï‚ (%)</label>
                    <input type="number" id="p-progress" min="0" max="100" value="0">
                </div>
            </div>
            <div class="form-row">
                <label>Î ÏÎ¿Ï‹Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ (â‚¬)</label>
                <input type="number" id="p-budget" placeholder="0">
            </div>
            <div class="form-row">
                <label>Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚</label>
                <textarea id="p-notes" placeholder="Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®, Ï€Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚..."></textarea>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost" onclick="closeModal('project-modal')">Î‘ÎºÏÏÏ‰ÏƒÎ·</button>
            <button class="btn btn-primary" onclick="saveProject()">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
        </div>
    </div>
</div>

<!-- TASK MODAL -->
<div class="modal-overlay" id="task-modal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title">ÎÎ­Î± Î•ÏÎ³Î±ÏƒÎ¯Î±</div>
            <button class="modal-close" onclick="closeModal('task-modal')">âœ•</button>
        </div>
        <div class="modal-body">
            <div class="form-row">
                <label>Î¤Î¯Ï„Î»Î¿Ï‚ Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚ *</label>
                <input type="text" id="t-title" placeholder="Ï€.Ï‡. Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚ ÎºÎ±Ï„ÏŒÏˆÎµÏ‰Î½">
            </div>
            <div class="form-row">
                <label>ÎˆÏÎ³Î¿</label>
                <select id="t-project"></select>
            </div>
            <div class="form-row-2">
                <div>
                    <label>Î ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î±</label>
                    <input type="date" id="t-due">
                </div>
                <div>
                    <label>Î ÏÎ¿Ï„ÎµÏÎ±Î¹ÏŒÏ„Î·Ï„Î±</label>
                    <select id="t-priority">
                        <option value="Î§Î±Î¼Î·Î»Î®">Î§Î±Î¼Î·Î»Î®</option>
                        <option value="ÎœÎ­Ï„ÏÎ¹Î±" selected>ÎœÎ­Ï„ÏÎ¹Î±</option>
                        <option value="Î¥ÏˆÎ·Î»Î®">Î¥ÏˆÎ·Î»Î®</option>
                        <option value="ÎšÏÎ¯ÏƒÎ¹Î¼Î·">ÎšÏÎ¯ÏƒÎ¹Î¼Î·</option>
                    </select>
                </div>
            </div>
            <div class="form-row">
                <label>Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚</label>
                <textarea id="t-notes" placeholder="Î›ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚..."></textarea>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost" onclick="closeModal('task-modal')">Î‘ÎºÏÏÏ‰ÏƒÎ·</button>
            <button class="btn btn-primary" onclick="saveTask()">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
        </div>
    </div>
</div>

<!-- NOTE MODAL -->
<div class="modal-overlay" id="note-modal">
    <div class="modal" style="width:420px">
        <div class="modal-header">
            <div class="modal-title">ÎÎ­Î± Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·</div>
            <button class="modal-close" onclick="closeModal('note-modal')">âœ•</button>
        </div>
        <div class="modal-body">
            <div class="form-row">
                <label>ÎšÎµÎ¯Î¼ÎµÎ½Î¿ Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·Ï‚</label>
                <textarea id="n-text" style="min-height:120px" placeholder="Î“ÏÎ¬ÏˆÎµ Ï„Î· ÏƒÎ·Î¼ÎµÎ¯Ï‰ÏƒÎ® ÏƒÎ¿Ï…..."></textarea>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost" onclick="closeModal('note-modal')">Î‘ÎºÏÏÏ‰ÏƒÎ·</button>
            <button class="btn btn-primary" onclick="saveNote()">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
        </div>
    </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA STORE (localStorage)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const KEYS = { projects: 'pm_projects', tasks: 'pm_tasks', notes: 'pm_notes' };

function load(key) {
    try { return JSON.parse(localStorage.getItem(key)) || []; } catch { return []; }
}

function save(key, data) {
    localStorage.setItem(key, JSON.stringify(data));
}

let projects = load(KEYS.projects);
let tasks = load(KEYS.tasks);
let notes = load(KEYS.notes);

// Seed demo data if empty
if (projects.length === 0) {
    projects = [
        { id: uid(), title: 'ÎœÎ¿Î½Î¿ÎºÎ±Ï„Î¿Î¹ÎºÎ¯Î± Î§Î±Î»ÎºÎ¹Î´Î¹ÎºÎ®Ï‚', client: 'Î Î±Ï€Î±Î´ÏŒÏ€Î¿Ï…Î»Î¿Ï‚ Î.', category: 'ÎšÎ±Ï„Î¿Î¹ÎºÎ¯Î±', start: '2025-01-10', end: '2025-09-30', status: 'Î£Îµ ÎµÎ¾Î­Î»Î¹Î¾Î·', progress: 65, budget: 280000, notes: 'Î™ÏƒÏŒÎ³ÎµÎ¹Î¿ + 1Î¿Ï‚ ÏŒÏÎ¿Ï†Î¿Ï‚, Ï€Î¹ÏƒÎ¯Î½Î±' },
        { id: uid(), title: 'Î•Î¼Ï€Î¿ÏÎ¹ÎºÏŒ ÎšÎ­Î½Ï„ÏÎ¿ Î˜ÎµÏƒÏƒÎ±Î»Î¿Î½Î¯ÎºÎ·Ï‚', client: 'Alpha Constructions', category: 'Î•Î¼Ï€Î¿ÏÎ¹ÎºÏŒ', start: '2024-11-01', end: '2026-06-30', status: 'Î£Îµ ÎµÎ¾Î­Î»Î¹Î¾Î·', progress: 30, budget: 1500000, notes: '' },
        { id: uid(), title: 'Î‘Î½Î±ÎºÎ±Î¯Î½Î¹ÏƒÎ· Î“ÏÎ±Ï†ÎµÎ¯Ï‰Î½', client: 'Î”Î®Î¼Î¿Ï‚ Î˜ÎµÏƒÏƒÎ±Î»Î¿Î½Î¯ÎºÎ·Ï‚', category: 'Î”Î·Î¼ÏŒÏƒÎ¹Î¿', start: '2025-03-01', end: '2025-07-31', status: 'Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚', progress: 10, budget: 95000, notes: 'Î¥Ï€ÏŒÎ³ÎµÎ¹Î¿ & Î¹ÏƒÏŒÎ³ÎµÎ¹Î¿ Î”Î·Î¼Î±ÏÏ‡ÎµÎ¯Î¿Ï…' },
        { id: uid(), title: 'Î’Î¹Î¿Î¼Î·Ï‡Î±Î½Î¹ÎºÎ® Î‘Ï€Î¿Î¸Î®ÎºÎ·', client: 'Logistics Pro AE', category: 'Î’Î¹Î¿Î¼Î·Ï‡Î±Î½Î¹ÎºÏŒ', start: '2024-06-01', end: '2025-02-28', status: 'ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿', progress: 100, budget: 420000, notes: '' },
    ];
    save(KEYS.projects, projects);
}

if (tasks.length === 0) {
    const pid = projects[0]?.id;
    tasks = [
        { id: uid(), title: 'Î‘ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® Î¼ÎµÎ»Î­Ï„Î· ÎºÎ±Ï„ÏŒÏˆÎµÏ‰Î½', project: pid, due: '2025-04-15', priority: 'Î¥ÏˆÎ·Î»Î®', notes: '', done: false },
        { id: uid(), title: 'Î£Ï„Î±Ï„Î¹ÎºÎ® Î¼ÎµÎ»Î­Ï„Î· Ï†Î­ÏÎ¿Î½Ï„Î¿Ï‚ Î¿ÏÎ³Î±Î½Î¹ÏƒÎ¼Î¿Ï', project: pid, due: '2025-05-01', priority: 'ÎšÏÎ¯ÏƒÎ¹Î¼Î·', notes: '', done: false },
        { id: uid(), title: 'ÎˆÎºÎ´Î¿ÏƒÎ· Î¿Î¹ÎºÎ¿Î´Î¿Î¼Î¹ÎºÎ®Ï‚ Î¬Î´ÎµÎ¹Î±Ï‚', project: pid, due: '2025-03-20', priority: 'ÎœÎ­Ï„ÏÎ¹Î±', notes: '', done: true },
        { id: uid(), title: 'Î¤Î¿Ï€Î¿Î³ÏÎ±Ï†Î¹ÎºÎ® Î±Ï€Î¿Ï„ÏÏ€Ï‰ÏƒÎ·', project: projects[1]?.id, due: '2025-02-28', priority: 'Î¥ÏˆÎ·Î»Î®', notes: '', done: true },
    ];
    save(KEYS.tasks, tasks);
}

function uid() { return Math.random().toString(36).slice(2,10); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let currentView = 'dashboard';

function navigate(view, el) {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById('view-' + view).classList.add('active');
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    if (el) el.classList.add('active');
    currentView = view;

    render();
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function render() {
    updateBadges();
    if (currentView === 'dashboard') renderDashboard();
    else if (currentView === 'projects') renderProjects();
    else if (currentView === 'tasks') renderTasks();
    else if (currentView === 'timeline') renderTimeline();
    else if (currentView === 'notes') renderNotes();
}

function updateBadges() {
    document.getElementById('nav-badge-projects').textContent = projects.length;
    document.getElementById('nav-badge-tasks').textContent = tasks.filter(t => !t.done).length;
}

// â”€â”€ STATUS BADGE â”€â”€
const STATUS_CLASSES = {
    'Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚': 'badge-blue',
    'Î£Îµ ÎµÎ¾Î­Î»Î¹Î¾Î·': 'badge-orange',
    'Î£Îµ Ï€Î±ÏÏƒÎ·': 'badge-yellow',
    'ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿': 'badge-green',
    'Î‘ÎºÏ…ÏÏ‰Î¼Î­Î½Î¿': 'badge-red',
};

const STATUS_COLORS = {
    'Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚': '#1a56db',
    'Î£Îµ ÎµÎ¾Î­Î»Î¹Î¾Î·': '#f97316',
    'Î£Îµ Ï€Î±ÏÏƒÎ·': '#d97706',
    'ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿': '#16a34a',
    'Î‘ÎºÏ…ÏÏ‰Î¼Î­Î½Î¿': '#dc2626',
};

const PRIORITY_CLASSES = {
    'Î§Î±Î¼Î·Î»Î®': 'badge-blue',
    'ÎœÎ­Ï„ÏÎ¹Î±': 'badge-yellow',
    'Î¥ÏˆÎ·Î»Î®': 'badge-orange',
    'ÎšÏÎ¯ÏƒÎ¹Î¼Î·': 'badge-red',
};

function statusBadge(s) {
    return `<span class="badge ${STATUS_CLASSES[s] || 'badge-blue'}">${s}</span>`;
}

function progressBar(pct, color) {
    color = color || '#1a56db';
    return `<div class="progress-wrap">
        <span style="font-size:12px;font-weight:600;color:var(--text-muted)">${pct}%</span>
        <div class="progress-bar"><div class="progress-fill" style="width:${pct}%;background:${color}"></div></div>
    </div>`;
}

// â”€â”€ DASHBOARD â”€â”€
function renderDashboard() {
    const total = projects.length;
    const active = projects.filter(p => p.status === 'Î£Îµ ÎµÎ¾Î­Î»Î¹Î¾Î·').length;
    const done = projects.filter(p => p.status === 'ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿').length;
    const pendingTasks = tasks.filter(t => !t.done).length;
    const designing = projects.filter(p => p.status === 'Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚').length;

    document.getElementById('stats-grid').innerHTML = `
        <div class="stat-card blue">
            <div class="stat-label">Î£ÏÎ½Î¿Î»Î¿ ÎˆÏÎ³Ï‰Î½</div>
            <div class="stat-value">${total}</div>
            <div class="stat-sub">ÎšÎ±Ï„Î±Ï‡Ï‰ÏÎ·Î¼Î­Î½Î± Î­ÏÎ³Î±</div>
        </div>
        <div class="stat-card purple">
            <div class="stat-label">Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚</div>
            <div class="stat-value">${designing}</div>
            <div class="stat-sub">Î£Îµ Ï†Î¬ÏƒÎ· ÏƒÏ‡ÎµÎ´Î¹Î±ÏƒÎ¼Î¿Ï</div>
        </div>
        <div class="stat-card orange">
            <div class="stat-label">Î•Î½ÎµÏÎ³Î¬ ÎˆÏÎ³Î±</div>
            <div class="stat-value">${active}</div>
            <div class="stat-sub">Î£Îµ ÎµÎ¾Î­Î»Î¹Î¾Î· Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î®</div>
        </div>
        <div class="stat-card green">
            <div class="stat-label">ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î±</div>
            <div class="stat-value">${done}</div>
            <div class="stat-sub">Î•Ï€Î¹Ï„Ï…Ï‡ÏÏ‚ Ï€Î±ÏÎ±Î´Î¿Î¸Î­Î½Ï„Î±</div>
        </div>
        <div class="stat-card red">
            <div class="stat-label">Î•ÎºÎºÏÎµÎ¼ÎµÎ¯Ï‚ Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚</div>
            <div class="stat-value">${pendingTasks}</div>
            <div class="stat-sub">Î ÏÎ¿Ï‚ Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·</div>
        </div>
    `;

    // Recent projects table
    const rows = projects.slice(-5).reverse().map(p => `
        <tr>
            <td><div class="project-name">${p.title}</div><div class="project-client">${p.client}</div></td>
            <td>${statusBadge(p.status)}</td>
            <td>${progressBar(p.progress, STATUS_COLORS[p.status])}</td>
            <td style="font-family:'DM Mono',monospace;font-size:13px">${p.end || 'â€”'}</td>
        </tr>
    `).join('') || `<tr><td colspan="4"><div class="empty"><div class="empty-icon">ğŸ—ï¸</div><h3>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î­ÏÎ³Î±</h3></div></td></tr>`;

    document.getElementById('dashboard-projects-tbody').innerHTML = rows;

    // Gantt
    const ganttRows = projects.map(p => `
        <div class="gantt-row">
            <div class="gantt-label">${p.title}</div>
            <div class="gantt-track">
                <div class="gantt-fill" style="width:${p.progress}%;background:${STATUS_COLORS[p.status] || '#1a56db'}">${p.progress > 8 ? p.progress + '%' : ''}</div>
            </div>
            <div class="gantt-pct">${p.progress}%</div>
        </div>
    `).join('') || '<div style="padding:20px;color:var(--text-muted)">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Î±</div>';
    document.getElementById('gantt-body').innerHTML = ganttRows;
}

// â”€â”€ PROJECTS â”€â”€
function renderProjects(filter) {
    let list = [...projects];
    if (filter) list = list.filter(p => p.title.toLowerCase().includes(filter) || p.client.toLowerCase().includes(filter));
    
    const rows = list.map(p => `
        <tr>
            <td>
                <div class="project-name">${p.title}</div>
                <div class="project-client">${p.client}</div>
            </td>
            <td><span class="badge badge-blue">${p.category}</span></td>
            <td>${statusBadge(p.status)}</td>
            <td>${progressBar(p.progress, STATUS_COLORS[p.status])}</td>
            <td style="font-family:'DM Mono',monospace;font-size:13px">${p.end || 'â€”'}</td>
            <td style="font-family:'DM Mono',monospace;font-size:13px">${p.budget ? 'â‚¬' + Number(p.budget).toLocaleString('el-GR') : 'â€”'}</td>
            <td>
                <button class="action-btn" onclick="editProject('${p.id}')" title="Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±">âœï¸</button>
                <button class="action-btn del" onclick="deleteProject('${p.id}')" title="Î”Î¹Î±Î³ÏÎ±Ï†Î®">ğŸ—‘ï¸</button>
            </td>
        </tr>
    `).join('');

    document.getElementById('projects-tbody').innerHTML = rows || `<tr><td colspan="7">
        <div class="empty"><div class="empty-icon">ğŸ—ï¸</div><h3>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î­ÏÎ³Î±</h3><p>Î Î±Ï„Î®ÏƒÏ„Îµ "+ ÎÎ­Î¿ ÎˆÏÎ³Î¿" Î³Î¹Î± Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÏ„Îµ</p></div>
    </td></tr>`;
}

// â”€â”€ TASKS â”€â”€
function renderTasks(filter) {
    let list = [...tasks];
    if (filter) list = list.filter(t => t.title.toLowerCase().includes(filter));

    const html = list.map(t => {
        const proj = projects.find(p => p.id === t.project);
        return `
            <li class="task-item">
                <div class="task-check ${t.done ? 'done' : ''}" onclick="toggleTask('${t.id}')">${t.done ? 'âœ“' : ''}</div>
                <div style="flex:1">
                    <div class="task-text ${t.done ? 'done' : ''}">${t.title}</div>
                    ${proj ? `<div class="task-meta">ğŸ“ ${proj.title}</div>` : ''}
                </div>
                <span class="badge ${PRIORITY_CLASSES[t.priority] || 'badge-blue'}">${t.priority}</span>
                ${t.due ? `<span style="font-size:12px;color:var(--text-muted);font-family:'DM Mono',monospace">${t.due}</span>` : ''}
                <button class="action-btn del" onclick="deleteTask('${t.id}')">ğŸ—‘ï¸</button>
            </li>
        `;
    }).join('') || `<div class="empty"><div class="empty-icon">âœ…</div><h3>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚</h3><p>Î Î±Ï„Î®ÏƒÏ„Îµ "+ ÎÎ­Î± Î•ÏÎ³Î±ÏƒÎ¯Î±" Î³Î¹Î± Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÏ„Îµ</p></div>`;

    document.getElementById('tasks-list').innerHTML = html;
}

// â”€â”€ TIMELINE â”€â”€
function renderTimeline() {
    const sorted = [...projects].sort((a, b) => (a.end || '').localeCompare(b.end || ''));
    const html = sorted.map(p => `
        <div class="gantt-row">
            <div class="gantt-label">
                <div style="font-weight:600;font-size:13px">${p.title}</div>
                <div style="font-size:11px;color:var(--text-muted)">${p.start || ''} â†’ ${p.end || ''}</div>
            </div>
            <div class="gantt-track">
                <div class="gantt-fill" style="width:${p.progress}%;background:${STATUS_COLORS[p.status] || '#1a56db'}">${p.progress > 8 ? p.progress + '%' : ''}</div>
            </div>
            <div>${statusBadge(p.status)}</div>
        </div>
    `).join('') || '<div style="padding:24px;color:var(--text-muted)">Î§Ï‰ÏÎ¯Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Î±</div>';

    document.getElementById('timeline-body').innerHTML = html;
}

// â”€â”€ NOTES â”€â”€
function renderNotes(filter) {
    let list = [...notes];
    if (filter) list = list.filter(n => n.text.toLowerCase().includes(filter));

    const colors = ['#1a56db','#f97316','#16a34a','#8b5cf6','#dc2626'];
    const html = list.map((n, i) => `
        <div class="note-card" style="border-top-color:${colors[i % colors.length]}">
            <div class="note-date">${n.date}</div>
            <div class="note-text">${n.text.replace(/\n/g,'<br>')}</div>
            <div class="note-actions">
                <button class="action-btn del btn btn-sm" onclick="deleteNote('${n.id}')">ğŸ—‘ï¸ Î”Î¹Î±Î³ÏÎ±Ï†Î®</button>
            </div>
        </div>
    `).join('') || `<div class="empty"><div class="empty-icon">ğŸ“</div><h3>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚</h3></div>`;

    document.getElementById('notes-grid').innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SEARCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function onSearch(q) {
    q = q.toLowerCase().trim();
    if (currentView === 'projects') renderProjects(q);
    else if (currentView === 'tasks') renderTasks(q);
    else if (currentView === 'notes') renderNotes(q);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROJECT CRUD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let editingProjectId = null;

function openProjectModal(id) {
    editingProjectId = id || null;
    const modal = document.getElementById('project-modal');
    document.getElementById('project-modal-title').textContent = id ? 'Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± ÎˆÏÎ³Î¿Ï…' : 'ÎÎ­Î¿ ÎˆÏÎ³Î¿';

    if (id) {
        const p = projects.find(p => p.id === id);
        document.getElementById('p-title').value = p.title;
        document.getElementById('p-client').value = p.client;
        document.getElementById('p-category').value = p.category;
        document.getElementById('p-start').value = p.start;
        document.getElementById('p-end').value = p.end;
        document.getElementById('p-status').value = p.status;
        document.getElementById('p-progress').value = p.progress;
        document.getElementById('p-budget').value = p.budget;
        document.getElementById('p-notes').value = p.notes;
    } else {
        ['p-title','p-client','p-start','p-end','p-notes'].forEach(id => document.getElementById(id).value = '');
        document.getElementById('p-progress').value = 0;
        document.getElementById('p-budget').value = '';
        document.getElementById('p-status').value = 'Î£Ï‡ÎµÎ´Î¹Î±ÏƒÎ¼ÏŒÏ‚';
    }

    modal.classList.add('open');
}

function editProject(id) { openProjectModal(id); }

function saveProject() {
    const title = document.getElementById('p-title').value.trim();
    if (!title) { alert('Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï„Î¯Ï„Î»Î¿ Î­ÏÎ³Î¿Ï….'); return; }

    const data = {
        title,
        client: document.getElementById('p-client').value.trim(),
        category: document.getElementById('p-category').value,
        start: document.getElementById('p-start').value,
        end: document.getElementById('p-end').value,
        status: document.getElementById('p-status').value,
        progress: parseInt(document.getElementById('p-progress').value) || 0,
        budget: parseFloat(document.getElementById('p-budget').value) || 0,
        notes: document.getElementById('p-notes').value.trim(),
    };

    if (editingProjectId) {
        const idx = projects.findIndex(p => p.id === editingProjectId);
        projects[idx] = { ...projects[idx], ...data };
    } else {
        projects.push({ id: uid(), ...data });
    }

    save(KEYS.projects, projects);
    closeModal('project-modal');
    render();
}

function deleteProject(id) {
    if (!confirm('Î”Î¹Î±Î³ÏÎ±Ï†Î® Î­ÏÎ³Î¿Ï…;')) return;
    projects = projects.filter(p => p.id !== id);
    save(KEYS.projects, projects);
    render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TASK CRUD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function openTaskModal() {
    const sel = document.getElementById('t-project');
    sel.innerHTML = '<option value="">â€” Î§Ï‰ÏÎ¯Ï‚ Î­ÏÎ³Î¿ â€”</option>' + projects.map(p => `<option value="${p.id}">${p.title}</option>`).join('');
    ['t-title','t-notes'].forEach(id => document.getElementById(id).value = '');
    document.getElementById('t-due').value = '';
    document.getElementById('t-priority').value = 'ÎœÎ­Ï„ÏÎ¹Î±';
    document.getElementById('task-modal').classList.add('open');
}

function saveTask() {
    const title = document.getElementById('t-title').value.trim();
    if (!title) { alert('Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï„Î¯Ï„Î»Î¿ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚.'); return; }

    tasks.push({
        id: uid(),
        title,
        project: document.getElementById('t-project').value,
        due: document.getElementById('t-due').value,
        priority: document.getElementById('t-priority').value,
        notes: document.getElementById('t-notes').value.trim(),
        done: false,
    });

    save(KEYS.tasks, tasks);
    closeModal('task-modal');
    render();
}

function toggleTask(id) {
    const t = tasks.find(t => t.id === id);
    if (t) t.done = !t.done;
    save(KEYS.tasks, tasks);
    render();
}

function deleteTask(id) {
    tasks = tasks.filter(t => t.id !== id);
    save(KEYS.tasks, tasks);
    render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NOTE CRUD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function openNoteModal() {
    document.getElementById('n-text').value = '';
    document.getElementById('note-modal').classList.add('open');
}

function saveNote() {
    const text = document.getElementById('n-text').value.trim();
    if (!text) return;
    notes.unshift({ id: uid(), text, date: new Date().toLocaleDateString('el-GR') });
    save(KEYS.notes, notes);
    closeModal('note-modal');
    render();
}

function deleteNote(id) {
    notes = notes.filter(n => n.id !== id);
    save(KEYS.notes, notes);
    render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODAL HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function closeModal(id) {
    document.getElementById(id).classList.remove('open');
}

// Close on overlay click
document.querySelectorAll('.modal-overlay').forEach(overlay => {
    overlay.addEventListener('click', function(e) {
        if (e.target === this) this.classList.remove('open');
    });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î— Î‘Î¡Î§Î•Î™ÎŸÎ¥ (Save As)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function saveAsFile() {
    // Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Ï„ÏÎ­Ï‡Î¿Î½ HTML Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï…
    const html = document.documentElement.outerHTML;

    // Î•Î½ÏƒÏ‰Î¼Î±Ï„ÏÎ½Î¿Ï…Î¼Îµ Ï„Î± Ï„ÏÎ­Ï‡Î¿Î½Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ HTML
    // ÏÏƒÏ„Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î½Î± ÎµÎ¯Î½Î±Î¹ Î±Ï…Ï„Î¬ÏÎºÎµÏ‚ Î¼Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î·Ï‚ ÏƒÏ…Î½ÎµÎ´ÏÎ¯Î±Ï‚
    const dataScript = `<script id="__seed_data__">
        (function() {
            if (!localStorage.getItem('pm_projects')) {
                localStorage.setItem('pm_projects', ${JSON.stringify(JSON.stringify(projects))});
            }
            if (!localStorage.getItem('pm_tasks')) {
                localStorage.setItem('pm_tasks', ${JSON.stringify(JSON.stringify(tasks))});
            }
            if (!localStorage.getItem('pm_notes')) {
                localStorage.setItem('pm_notes', ${JSON.stringify(JSON.stringify(notes))});
            }
        })();
    <\/script>`;

    // Î•Î¹ÏƒÎ¬Î³Î¿Ï…Î¼Îµ Ï„Î¿ script Î±Î¼Î­ÏƒÏ‰Ï‚ Î¼ÎµÏ„Î¬ Ï„Î¿ <head>
    const finalHtml = html.replace('<head>', '<head>' + dataScript);

    const blob = new Blob([finalHtml], { type: 'text/html;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    const now = new Date();
    const dateStr = now.toISOString().slice(0,10);
    a.href = url;
    a.download = `PinakasElegxou_${dateStr}.html`;
    a.click();
    URL.revokeObjectURL(url);

    // Î•Î¹Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ·
    const msg = document.createElement('div');
    msg.style.cssText = 'position:fixed;bottom:24px;right:24px;background:#16a34a;color:#fff;padding:12px 20px;border-radius:10px;font-size:14px;font-weight:600;z-index:9999;box-shadow:0 4px 12px rgba(0,0,0,0.15);animation:fadeIn 0.2s ease';
    msg.textContent = 'âœ… Î¤Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚!';
    document.body.appendChild(msg);
    setTimeout(() => msg.remove(), 3000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.addEventListener('DOMContentLoaded', function() {
    render();
});
</script>
</body>
</html>